#!/bin/bash

set -e

exec 3>&1
exec 1>&2

# This is a read-only resource, so out just returns the input version
payload=$(mktemp)
cat > "$payload" <&0

# Extract version from input
version=$(jq -r '.version // {}' < "$payload")

# Return the same version
result=$(jq -n --argjson version "$version" '{version: $version, metadata: []}')

rm "$payload"

echo "$result" >&3